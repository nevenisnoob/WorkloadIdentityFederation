# This is a basic workflow to help you get started with Actions

name: key-rotator

on:
  # https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#onschedule
  # 毎月十日の夜中3時実行する(18 + 9 = 27)
  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "monitoring"
  key_rotation:
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
      - uses: actions/checkout@v3
      - id: 'auth'
        name: 'Authenticate to Google Cloud'
        uses: 'google-github-actions/auth@v1'
        with:
          credentials_json: '${{ secrets.TEMP_SA_KEY_FOR_ROTATION_VALIDATION }}'
      - name: run gcloud command to validate the new sa key
        run: gcloud info
